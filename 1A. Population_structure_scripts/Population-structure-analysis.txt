Population structure analysis;

1A/ Filtering VCF for ADMIXTURE
1A.bcftools_filter_beans.sh

1B/ Max Heterozygosity filtering in TASSEL

1C/ Pruning and thinning VCF for ADMIXTURE
sbatch -J bcftools --mem 30G -c 1 -N 1 -p ei-medium --wrap "source bcftools-1.10.2;bcftools +prune -l 0.5 -w 1000 Andean_Haplotypecaller_filtered_maxhetero0.2_ID.vcf.gz -Oz -o Andean_Haplotypecaller_filtered_maxhetero0.2_ID_LD-0.5.vcf.gz"

2A/ Convert VCF to bed file for ADMIXTURE
sbatch -J plink -o plink.log --mem 50G -c 1 -N 1 -p ei-medium -t 2-0 --wrap "source plink-1.90;plink --vcf Andean_Haplotypecaller_filtered_maxhetero0.2_ID_LD-0.5_thin-w10.vcf.gz --make-bed --out Andean_Haplotypecaller_filtered_maxhetero0.2_ID_LD-0.5_thin-w10"

2B/ Run ADMIXTURE
2B.ADMIXTURE.sh

2B/ Or run ADMIXTURE as an array
2B.ADMIXTURE_array.sh

2C/ Run cross validation error for ADMIXTURE
2C.ADM_CV_error.sh

3/ Plotting in R
3.Pophelper.R
4.ggplot_ADMX.r
5.CV_error.R

4/ Can plot PCA from this 

6.PCAs-ADMX.R